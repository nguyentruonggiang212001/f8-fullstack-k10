"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2d45c2cb-cfb6-5d80-89b0-0b732460c99b")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[9082],{780634:(e,t,n)=>{n.d(t,{Do:()=>u,Du:()=>p,El:()=>h,JO:()=>v,Jx:()=>E,Lp:()=>I,Mc:()=>g,ON:()=>r,RW:()=>_,Rq:()=>s,Vr:()=>f,Vs:()=>C,Y:()=>l,YZ:()=>d,ZF:()=>k,h3:()=>y,hu:()=>m,jG:()=>c,kL:()=>a,qc:()=>i,qp:()=>b,se:()=>o,xn:()=>w});let a="post_to_feed_view--container--BiDZs",o="post_to_feed_view--noContentContainer--VE8Tm post_to_feed_view--container--BiDZs text--fontPos16--oMC-G text--_fontBase--QdLsd",l="post_to_feed_view--searchFilterContainer--lyX72",r="post_to_feed_view--searchBar--IwmvI",i="post_to_feed_view--searchIcon---WXsZ",s="post_to_feed_view--caretIcon--akCZQ",d="post_to_feed_view--pageMenuDropdown--bS4RV",c="post_to_feed_view--scrollContainer--syalR",m="post_to_feed_view--innerScrollContainer--aP8K2",u="post_to_feed_view--loadingSpinnerContainer--E8n20",_="post_to_feed_view--pageSection--85j7J",f="post_to_feed_view--pageHeader--ZOfTF",p="post_to_feed_view--pageHeaderFaint--p-zwO",g="post_to_feed_view--tilesGrid--Ft03l",C="post_to_feed_view--tile--9a4ta",h="post_to_feed_view--selectedTile--D6T9A post_to_feed_view--tile--9a4ta",y="post_to_feed_view--tileThumbnail--FkrR9",E="post_to_feed_view--tileOverlay--iyl2x",v="post_to_feed_view--tileDetails--FZrxQ",b="post_to_feed_view--nodeName--jbJro",w="post_to_feed_view--thumbnail--uAumv",I="post_to_feed_view--notFoundContainer--5cMl3 text--fontPos16--oMC-G text--_fontBase--QdLsd",k="post_to_feed_view--searchQuery--TIyhI"},470400:(e,t,n)=>{n.d(t,{CQ:()=>i,DA:()=>v,Ev:()=>x,Fd:()=>u,Hc:()=>o,JT:()=>N,KG:()=>b,OW:()=>F,RO:()=>g,Ru:()=>k,UD:()=>d,YI:()=>_,_5:()=>T,_f:()=>s,aF:()=>c,ku:()=>h,lt:()=>y,oW:()=>I,oj:()=>S,pb:()=>f,q3:()=>E,w8:()=>l,wg:()=>w,xe:()=>r,y3:()=>a,yD:()=>m,zE:()=>C,zb:()=>p});let a="create_feed_post_modal--avatarFloat--iIveN",o="create_feed_post_modal--modalHeader---WjMY permissions_modal--fileTitle--487xP",l="create_feed_post_modal--addBorder--ioWGk",r="create_feed_post_modal--contentContainerV2--QwkuY",i="create_feed_post_modal--buttonRowV3--5nAjk modal--buttonRow--o2A0S",s="create_feed_post_modal--buttonRowLeft--TRB9A",d="create_feed_post_modal--buttonContainer--eO4q8",c="create_feed_post_modal--inputSectionMinimized--bq7wz create_feed_post_modal--inputSection--7p1jN",m="create_feed_post_modal--inputFields--bFFV7",u="create_feed_post_modal--draftText--n3VG5",_="create_feed_post_modal--postLoadingSpinner--rky-A",f="create_feed_post_modal--postButton--kaBoj",p="create_feed_post_modal--postingButton--VH5JE create_feed_post_modal--postButton--kaBoj",g="create_feed_post_modal--modalWrapper--4Bi1n",C="create_feed_post_modal--modalWrapperMinimized--syjBM create_feed_post_modal--modalWrapper--4Bi1n",h="create_feed_post_modal--contentNonEmpty--vTrJ6",y="create_feed_post_modal--contentWrapperMinimizedV2--Y56bB create_feed_post_modal--contentWrapperV2--CuYTA",E="create_feed_post_modal--contentWrapperV3--bCplT create_feed_post_modal--contentWrapperV2--CuYTA",v="create_feed_post_modal--descriptionWrapperV3--KrwNd",b="create_feed_post_modal--avatarAndDescriptionWrapperMinimized--yrvzI create_feed_post_modal--avatarAndDescriptionWrapper--JTvU3",w="create_feed_post_modal--minimizedButtonContainerV2--ZJZV- create_feed_post_modal--minimizedButtonContainer--fxgaf",I="create_feed_post_modal--containerPicker--gOWkH",k="create_feed_post_modal--containerPickerTextDisabled--rvG3l",x="create_feed_post_modal--containerButtonDisabled--Qtxk7 create_feed_post_modal--containerButton--CgmgL",S="create_feed_post_modal--containerButtonInner--AiLpd",N="create_feed_post_modal--containerButtonText--99vNr",F="create_feed_post_modal--caret--dGHxv",T="create_feed_post_modal--loadingWrapper--mesOB"},290237:(e,t,n)=>{n.d(t,{X:()=>o});var a=n(547807);let o=new class{constructor(){this.GetDefaultContainerSchemaValidator=(0,a.vh)(),this.SetDefaultContainerSchemaValidator=(0,a.vh)()}getDefaultContainer(e){return this.GetDefaultContainerSchemaValidator.validate(async({xr:t})=>await t.get(`/api/feed_default_container/${e.orgId}`))}setDefaultContainer(e){return this.SetDefaultContainerSchemaValidator.validate(async({xr:t})=>await t.post("/api/feed_default_container",a.td.toAPIParameters(e)))}}},118143:(e,t,n)=>{n.r(t),n.d(t,{CreateFeedPostContent:()=>e_,CreateFeedPostModal:()=>eu,getUploadErrorMessage:()=>em});var a=n(411855),o=n(188507),l=n(629019),r=n.n(l),i=n(776250),s=n(935283),d=n(609494),c=n(358145),m=n(966712),u=n(374626),_=n(498750),f=n(860601),p=n(395900),g=n(743282),C=n(27087),h=n(448169),y=n(946689),E=n(493323),v=n(574176),b=n(762638),w=n(881388),I=n(939863),k=n(392592),x=n(67294),S=n(738269),N=n(507877),F=n(662275),T=n(694687),D=n(860178),M=n(99506),P=n(204279),O=n(531827),A=n(28588),B=n(103271),L=n(290237),R=n(320063),K=n(763223),W=n(456104),U=n(318812),z=n(309798),H=n(397065),$=n(340514),G=n(864114),Q=n(463546),V=n(919960);function Z(){let e=(0,W.e)({overlay:Q.K69,priority:H.N.DEFAULT_MODAL}),t=(0,U.BK)(V.lU),n=(0,K.w)(),o=!!(0,z.f)("has_seen_feed_audience_selection_overlay"),l=a.useMemo(()=>!o&&!!n&&!t.showing,[o,n,t.showing]);return(0,R.h)(()=>{l&&e.show()}),a.useEffect(()=>{t.showing&&e.complete()},[t.showing,e]),a.createElement($.rq,{isShowing:e.isShowing,zIndex:G.R.MODAL,targetKey:"feed-audience-container-selection-nux",trackingContextName:"Team feed first audience container selection",title:(0,I.tx)("rcs.feed_onboarding.audience_selection.title"),description:a.createElement("p",{"data-testid":"team-feed-first-time-post"},(0,I.tx)("rcs.feed_onboarding.audience_selection.content")),onClose:e.complete,userFlagOnShow:"has_seen_feed_audience_selection_overlay",emphasized:!0})}var q=n(49218),j=n(261076),X=n(126674),Y=n(679736),J=n(406158),ee=n(301799),et=n(583630),en=n(660040),ea=n(563288),eo=n(160156),el=n(339617),er=n(782680),ei=n(988898),es=n(470400),ed=n(112512);let ec=[Y.My.CONTEXT_MENU,Y.My.SHARE];function em(e){switch(e.type){case A.Wn.MAX_UPLOADS_EXCEEDED:return(0,I.t)("fig_feed.too_many_content_items",e.params);case A.Wn.MAX_VIDEO_SIZE_EXCEEDED:return(0,I.t)("fig_feed.video_file_size_limit_MB",e.params);case A.Wn.MAX_IMAGE_SIZE_EXCEEDED:return(0,I.t)("fig_feed.image_file_size_limit_MB",e.params);case A.Wn.INVALID_FILE_TYPE:return(0,I.t)("fig_feed.unsupported_file_types_were_not_uploaded");case A.Wn.DUPLICATE_FILE_UPLOAD:return(0,I.t)("fig_feed.already_uploaded_items",e.params);case A.Wn.FAILED_TO_UPLOAD:return(0,I.t)("fig_feed.error_on_feed_post_creation");default:(0,s.xb)(e)}}function eu(e){let t=(0,o.wA)(),n=(0,T.sZ)(),l=(0,j.R)(),r=a.useCallback(()=>{t(F.Ce())},[t]),i=((null==n?void 0:n.name)&&(0,I.tx)("fig_feed.post_to_org_feed",{orgName:n.name}))??(0,I.tx)("fig_feed.post_to_feed");return a.createElement(q.hZ,{header:a.createElement("div",{className:es.Hc},i),onClose:()=>l(r),maxWidth:q.Fo,disableFixedTop:!0,closeOnEsc:!0},a.createElement(e_,{nodeInfo:e.nodeInfo,uploadInfo:e.uploadInfo,prototypeInfo:e.prototypeInfo,pageBackgroundColor:e.pageBackgroundColor,onSubmitSuccess:e.onSubmitSuccess,entryPoint:e.entryPoint,lockedFileKey:e.lockedFileKey}))}function e_(e){var t,n;let l=(0,o.wA)(),s=(0,T.sZ)(),R=(0,D.iZ)(),[K,W]=(0,u.fp)(j.T),[U,z]=a.useState(!1),[H,$]=a.useState(!0),[G,Q]=a.useState(!1),[eu,e_]=a.useState(!1),[ef,ep]=a.useState((0,I.t)("fig_feed.title_input_placeholder")),eg={id:(null==s?void 0:s.id)??"",type:M.Gr.ORG,name:(null==s?void 0:s.name)??"",isPrivate:!1},[eC,eh]=a.useState(eg),[ey,eE]=a.useState(eg);a.useEffect(()=>{s&&L.X.getDefaultContainer({orgId:null==s?void 0:s.id}).then(({data:e})=>{if(e.meta){let t={id:e.meta.container_id,type:(0,ea.Ti)(e.meta.container_type),name:e.meta.container_name,isPrivate:e.meta.is_private};eE(t),eh(t)}})},[s]);let[ev,eb]=a.useState(e.nodeInfo??null),ew=e.setMinimized,eI=a.useCallback(e=>{ew&&ew(e)},[ew]),ek=(0,o.d4)(e=>e.modalShown),[ex,eS]=a.useState((0,g.g)()),[eN,eF]=a.useState(0),eT=a.useCallback(()=>{eV(""),eq([]),eI(!0),Q(!1),eL([]),eS((0,g.g)()),eF(0),eb(null)},[eI]),eD=a.useCallback(()=>{l((0,F.to)({type:er.h,data:{onConfirm:eT},showModalsBeneath:!0}))},[l,eT]),eM=()=>{ep(B.ZP[Math.floor(Math.random()*B.ZP.length)]())};a.useEffect(()=>{eM()},[]);let eP=e.pageBackgroundColor,eO=(null==ev?void 0:ev.fileKey)??(null==(t=e.prototypeInfo)?void 0:t.fileKey)??"";a.useEffect(()=>{let t={entryPoint:e.entryPoint};eO&&(t.fileKey=eO),(0,i.sx)("Team Feed Create Post Modal Opened",t)},[e.entryPoint,eO]);let eA=a.useCallback((e,t)=>{if(t){l(F.Ce());return}let n={text:(0,I.t)("fig_feed.view_post"),action:()=>{l(N.V3({url:(0,X.Kc)(s.id,{uuid:e})}))}};l(k.F.enqueue({message:(0,I.t)("fig_feed.posted_to_org_feed",{orgName:s.name}),button:n})),l(F.Ce())},[l,s]),[eB,eL]=a.useState([]),eR=a.useMemo(()=>new Set(eB.map(e=>e.displayContentItem.type===B.cM.NODE?e.displayContentItem.nodeId:null).filter(e=>null!==e)),[eB]);a.useEffect(()=>{(0,ee.sr)(ev,eR,eL,null==s?void 0:s.id,eP)},[ev,eR,eL,null==s?void 0:s.id,eP]);let eK=a.useRef(null);a.useEffect(()=>{let t=e.prototypeInfo;if(!(null==s?void 0:s.id)||!t||eK.current)return;let n=(0,J.WI)(t,s.id);eK.current=n.displayContentItem,eL(e=>[...e.filter(e=>e.displayContentItem.type!==B.cM.PROTOTYPE),n])},[null==s?void 0:s.id,e.prototypeInfo]);let eW=a.useCallback(e=>{let t=(0,eo.K1)(eB[eN].displayContentItem);eF(e.findIndex(e=>(0,eo.K1)(e)===t));let n=[];e.forEach(e=>{let t=(0,eo.K1)(e),a=eB.find(e=>(0,eo.K1)(e.displayContentItem)===t);a?n.push(a):console.error("Expected to have a matchedPendingItem")}),eL(n)},[eB,eN]),eU=a.useCallback(e=>{eF(eB.findIndex(t=>(0,eo.K1)(t.displayContentItem)===e))},[eB]),{setContentPreview:ez,snapshotStates:eH}=(0,ee.eh)(eB,eL),{onSubmitSuccess:e$}=e,eG=a.useCallback((t,n)=>{C.Ay.post("/api/feed_posts",t).then(t=>{ec.includes(e.entryPoint)?eA(t.data.meta.public_uuid,n):(eT(),eM()),n&&l(k.F.enqueue({message:(0,I.t)("fig_feed.post_submission_pending")})),e$&&e$(n)}).catch(()=>{l(w.s.error((0,I.t)("fig_feed.error_on_feed_post_creation"))),$(!1)})},[l,eA,e$,eT,e.entryPoint]),[eQ,eV]=a.useState(""),[eZ,eq]=a.useState([]),ej=a.useMemo(()=>({library:new O.M8(s.id)}),[s]);a.useEffect(()=>{$(eQ.trim().length>en.Y||(0,d._Z)(eZ).length>en.e||0===eB.length)},[eQ,eZ,eB.length]),a.useEffect(()=>{let e=eQ.trim().length>0||!(0,d.I)(eZ);z(e||eB.length>0),W(e)},[eZ,W,eQ,eB.length]);let eX=e.lockedFileKey||(null==ev?void 0:ev.fileKey),eY=async t=>{let n=new p.M4;if(n.start(),(0,i.sx)("team_feed_onsubmit",{currentOrgPresent:!!s,submitDisabled:H},{logFromProber:!0}),!s||H)return;null==t||t.preventDefault(),$(!0);let a={description_meta:eZ,org_id:s.id};a.background_color=eP;let o=(0,d._Z)(eZ);a.content=await (0,J.pj)(l,eB,eO,eQ),(0,i.sx)("team_feed_content_awaited",{payloadContent:JSON.stringify(a.content)},{logFromProber:!0});let r=a.content.some(e=>e.pending);a.uuid=ex,eQ?a.title=eQ:a.title=o.length>0?o.slice(0,40)+"\u2026":(0,I.t)("fig_feed.untitled_post"),eC.id&&eC.type&&(a.container_id=eC.id,a.container_type=(0,ea.FD)(eC.type)),eX&&(a.attached_file_key=eX),eG(a,r),n.stop(),(0,i.sx)("team_feed_click_to_post_latency",{elapsedTimeMs:n.getElapsedTime()},{forwardToDatadog:!0}),(0,i.sx)("Team Feed New Post Submitted",{fileKey:eO,entryPoint:e.entryPoint,text:o,numContentItems:a.content.length,contentItemTypes:a.content.map(e=>e.type),containerId:a.container_id,containerType:a.container_type,isCurrentDefaultContainer:a.container_id===ey.id&&a.container_type===ey.type},{forwardToDatadog:!0})},eJ=a.useCallback((e,t)=>{if(!s)return;let n=Array.from(e);if(0===n.length)return;let a=(0,P.KT)(n,eB.length,B.e3,B.bB,e=>{l(k.F.enqueue({message:em(e)}))},eB.map(e=>e.fileIdentifier)).map(e=>{let t=(0,P.Fn)(e);if(A.xp.includes(e.type))return(0,J.zr)(t,e);if(A.VY.includes(e.type))return(0,J.X2)(t,ex,s.id,e);throw Error("unexpected file type")}),o=void 0!==t?t:eB.length;eL(e=>[...e.slice(0,o),...a,...e.slice(o)]),eF(o)},[l,s,ex,eB]),e0=a.useCallback((e,t)=>()=>{var n;let a=(null==(n=e.current)?void 0:n.files)||null;null!==a&&0!==a.length&&(eJ(a,t),eI(!1),e.current&&(e.current.value=""))},[eJ,eI]),e1=(0,c.ZC)(e.uploadInfo);a.useEffect(()=>{e.uploadInfo&&e.uploadInfo!==e1&&(eI(!1),eJ(e.uploadInfo))},[e.uploadInfo,e1,eI,eJ]);let e6=a.useCallback(e=>{let t=Math.min(e,Math.max(0,eB.length-2)),n=eB[e];if((0,J.AK)(n),eL(t=>t.filter((t,n)=>n!==e)),n.displayContentItem.type===B.cM.NODE){let e=n.displayContentItem.nodeId;eb(t=>{if(t){let n=t.nodeIds.filter(t=>t!==e),a=t.nodeThumbnails,o=a&&n.reduce((e,t)=>(e[t]=a[t],e),{});return{...t,nodeIds:n,nodeThumbnails:o}}return null})}eF(t)},[eB]),e3=a.useCallback((e,t)=>{eJ(e.files,t),e_(!1)},[eJ]),e8=a.useRef(null),e2=!!(null==(n=null==ev?void 0:ev.nodeIds)?void 0:n.length),{openPostFromFileModal:e7,attachedFileData:e9}=(0,ee.Ld)({setLinkedFileNodeInfo:eb,numUserContentItems:eB.length,hasNodeContent:e2,parentModalRef:e8,attachedFileKey:eX,lockedFileKey:e.lockedFileKey,currentOrgId:null==s?void 0:s.id}),e4=a.useCallback(()=>{let e=eB.map(e=>e.displayContentItem);return a.createElement(h.Y,{className:r()(es.xe,eu&&es.w8),isDragTarget:()=>!0,onTargetDragEnter:()=>e_(!0),onTargetDragLeave:()=>e_(!1),onTargetDrop:e=>e3(e)},a.createElement(eo.Zo,{contentItems:e,staticContent:!0,scrollable:!1,deleteItemAtIdx:G?void 0:e6,pageBackgroundColor:eP,onReorderCallback:G?void 0:eW,shouldScrollToIndex:null,selectedIdx:eN,setSelectedIdx:eF,onFileInputChange:e0,setSelectedContent:eU,snapshotStates:eH,setContentPreview:ez,openPostFromFileModal:e7,attachedFile:e9,dragging:eu,mode:"create"}))},[eP,eu,eW,e6,G,eB,e3,eN,e0,eU,eH,ez,e7,e9]),e5=a.useCallback(e=>{e.keyCode===_.Uz.ESCAPE&&eI(!0)},[eI]),te=a.useCallback(()=>{ek||(U&&(eV(e=>e.trim()),(0,d.I)(eZ)&&eq([])),eI(!0))},[eZ,eI,ek,U]),tt=a.useCallback(()=>{te(),l(F.Ce())},[l,te]),tn=a.createElement("div",{className:r()(es.zE,K&&es.ku),onKeyDown:e.disabled?f.lQ:e5,role:"textbox",tabIndex:0,onClick:()=>!e.disabled&&eI(!1)},R&&a.createElement("div",{className:es.y3},a.createElement(el.A,{user:R,size:x.Pf.LARGE})),a.createElement("div",{className:es.lt},a.createElement("div",{className:es.KG},a.createElement("div",{className:es.aF},a.createElement("div",{className:es.yD},eQ||ef," ",eQ&&a.createElement("span",{className:es.Fd},(0,I.t)("fig_feed.draft")))),a.createElement("div",{className:es.wg},a.createElement(y.$$,{disabled:!0,dataTestId:"feed-post-post"},(0,I.tx)("fig_feed.post")))))),ta=a.createElement("div",{className:es.RO,onKeyDown:e5,role:"textbox",tabIndex:0,onClick:()=>eI(!1),ref:e8},a.createElement("div",{className:es.q3},e4(),s&&R?a.createElement("div",{className:es.DA},a.createElement(et.FeedPostUnifiedComposer,{user:R,currentOrgId:s.id,autofocus:!0,mentionables:ej,onSubmit:H?void 0:eY,submitOnEnter:!1,hideSubmitButton:!0,description:eZ,updateDescription:eq,title:eQ,updateTitle:eV,displayDecoratorsDownwards:!0,minimized:e.minimized,readOnly:G,editableTypeaheadClass:ei.up,openPostFromFileModal:()=>e7({skipFrameSelection:!e2}),fileData:e9,lockFileAddition:eB.length>=B.e3,parentRef:e8,canUnlinkFile:!e2&&!e.lockedFileKey,unlinkFile:()=>eb(null)})):null),a.createElement("div",{className:es.CQ},a.createElement("div",{className:es._f},a.createElement("div",{className:b.cx.flex.itemsCenter.$},(0,I.tx)("fig_feed.post_to"),a.createElement(V.zr,{dropdownId:V.lU,orgId:s.id,defaultContainer:ey,selectedContainer:eC,onContainerSelect:e=>{eh(e),l(S.oB())},onSetDefaultContainer:eE,hideAllSpaces:!0,showMemberCount:!0,showUnusedContainers:!0},a.createElement("div",{className:b.cx.flex.justifyCenter.itemsCenter.ml8.pr4.pl8.h32.maxW300.borderBox.bRadius5.colorBorder.b1.bSolid.overflowHidden.selectNone.$,"data-onboarding-key":"feed-audience-container-selection-nux"},a.createElement(V.xM,{option:eC,defaultContainer:ey,showMemberCount:!1}),a.createElement("div",{className:es.OW},a.createElement(v.B,{svg:ed.A})))),a.createElement(Z,null))),a.createElement("div",{className:es.UD},!ec.includes(e.entryPoint)&&(U?a.createElement(y.nR,{onClick:e=>{e.stopPropagation(),eD()}},(0,I.tx)("fig_feed.discard_draft")):a.createElement(y.nR,{onClick:e=>{e.stopPropagation(),eT()}},(0,I.tx)("general.cancel"))),a.createElement(y.$$,{onClick:e=>{if(!G)return Q(!0),eY(e).finally(()=>{Q(!1)})},disabled:H,dataTestId:"feed-post-post",className:G?es.zb:es.pb},G&&a.createElement("div",{className:es.YI},a.createElement(E.kt,{shouldMatchTextColor:!0,size:"medium"})),G?(0,I.tx)("fig_feed.posting"):(0,I.tx)("fig_feed.post"))))),to=((null==s?void 0:s.name)&&(0,I.tx)("fig_feed.post_to_org_feed",{orgName:s.name}))??(0,I.tx)("fig_feed.post_to_feed");return s&&R&&(0,m.kc)().xr_debounce_threshold?e.entryPoint===Y.My.FEED_HEADER?a.createElement(a.Fragment,null,tn,!e.minimized&&a.createElement(q.hZ,{header:a.createElement("div",{className:es.Hc},to),onClose:tt,maxWidth:q.Fo,disableFixedTop:!0},ta)):ta:null}},301799:(e,t,n)=>{n.d(t,{sr:()=>z,eh:()=>$,Ld:()=>H});var a=n(411855),o=n(109388),l=n(188507),r=n(539321),i=n(939863),s=n(392592),d=n(662275),c=n(421123),m=n(691205),u=n(103271),_=n(406158),f=n(160156),p=n(629019),g=n.n(p),C=n(935283),h=n(540193),y=n(823810),E=n(391388),v=n(860601),b=n(768137),w=n(493323),I=n(827586),k=n(205054),x=n(860178),S=n(498606),N=n(237870),F=n(761939),T=n(706638),D=n(227795),M=n(585878);let P="post_from_file_modal--grid--JdmAi",O="post_from_file_modal--searchLoadingSpinnerContainer---qSgU post_from_file_modal--loadingSpinnerContainer--QaXkG";var A=n(647173);let B=`https://${window.location.host}`;var L=(e=>(e[e.SELECT_FILE=1]="SELECT_FILE",e[e.SELECT_NODE=2]="SELECT_NODE",e))(L||{});function R(e){let t=a.useRef(null),n=(0,x.TA)(),o=encodeURIComponent(`${e.selectedFile.url}?fuid=${n}&post-to-feed=1&force-incremental=0`),l=`${B}/embed?integration_host=fig-feed&url=${o}`,[r,s]=a.useState(!1),[d,c]=a.useState([]);a.useEffect(()=>{let e=e=>{if(window.parent.origin!==e.origin)return;let{type:t,data:n}=e.data;t===T.v.LOADED&&s(()=>!0),t===T.v.SELECT_NODE&&c(()=>n??[])};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);let m=d.length>0;return a.createElement(a.Fragment,null,!r&&a.createElement("div",{className:"post_from_file_modal--embedLoadingSpinnerContainer--x0E-V post_from_file_modal--loadingSpinnerContainer--QaXkG"},a.createElement(w.kt,{size:"large"})),a.createElement("iframe",{ref:t,className:"post_from_file_modal--iframe--W8QSR",title:"Figma",src:l,scrolling:"no"}),a.createElement("div",{className:"post_from_file_modal--footer--UhneR"},a.createElement(b.$$,{onClick:t=>{var n;t.stopPropagation(),e.setNodeInfo({fileKey:e.selectedFile.key,nodeIds:d.map(e=>e.guid),nodeThumbnails:d.reduce((e,{guid:t,thumbnail:n})=>{let a=new Blob([n]),o=URL.createObjectURL(a);return{...e,[t]:o}},{}),backgroundColorByNode:d.reduce((e,{guid:t,backgroundColor:n})=>n?{...e,[t]:n}:e,{})}),null==(n=e.hideModal)||n.call(e)},disabled:!m},(0,i.tx)("fig_feed.add_to_post"))))}function K(e){let t=(0,h.ql)(e.orgId),n=E.Qw.useTransformShallowEqual(t,e=>e.filter(e=>e.can_edit)),o="loaded"===n.status,{setSelectedFile:l,onAfterSelect:r}=e,s=a.useCallback(e=>{l(e),r()},[l,r]),[d,c]=a.useState(""),[m,u]=a.useState(null),_=a.useMemo(()=>(null==m?void 0:m.map(e=>e.model.key))??[],[m]),f=(0,y.IT)(_),p=a.useMemo(()=>null===m?null:"loaded"===f.status?m.filter(e=>{var t;return null==(t=f.data[e.model.key])?void 0:t.canEdit}):null,[f,m]),g=a.useCallback(e=>a.createElement("div",{className:"post_from_file_modal--tileContainer--f1mpx",onClick:()=>{s(e)},role:"button",tabIndex:0,key:`tile-${e.key}`},a.createElement("div",{className:"post_from_file_modal--chooseFile--3ABxf"},(0,i.t)("fig_feed.choose_file")),a.createElement(k.GQ,{file:e,currentUser:null,activeFileUsers:[],subtitle:a.createElement(k.lJ,{file:e}),onClick:v.lQ})),[s]),C=a.useMemo(()=>d?p?0===p.length?a.createElement("div",{className:"post_from_file_modal--notFoundContainer--JLJWT text--fontPos16--oMC-G text--_fontBase--QdLsd"},a.createElement("div",null,(0,i.tx)("community.universal_posting_modal.recent_editable_files_search.no_files_matching",{searchQuery:a.createElement(a.Fragment,null,a.createElement("span",{className:"post_from_file_modal--searchQuery--GpUQJ"},d))}))):a.createElement(I.P,{hideScrollbar:!0},a.createElement("div",{className:P},p.map(e=>g(e.model)))):a.createElement("div",{className:O},a.createElement(w.kt,{size:"large"})):n.data&&a.createElement(I.P,{hideScrollbar:!0},a.createElement("div",{className:P},n.data.map(e=>g(e)))),[n.data,p,d,g]);return o?a.createElement(a.Fragment,null,a.createElement("div",{className:"post_from_file_modal--searchContainer--oiMYX"},a.createElement(F.IW,{query:d,setQuery:c,setSearchResults:u,placeholderText:(0,i.t)("fig_feed.search_files")})),C):a.createElement("div",{className:O},a.createElement(w.kt,{size:"large"}))}function W(e){let{setModalPage:t,orgId:n,setSelectedFile:o}=e;return a.createElement(K,{orgId:n,setSelectedFile:o,onAfterSelect:e.skipFrameSelection?e.hideModal:()=>{null==t||t(2)}})}let U=(0,N.Ju)(function(e){let t=(0,l.wA)(),n=()=>{var n,a;t(d.Lo()),null==(a=null==(n=e.parentRef)?void 0:n.current)||a.focus()},[o,r]=a.useState(e.attachedFile),[s,c]=a.useState(e.lockFileSelection||e.attachedFile?2:1),{setFeedPostNodeInfo:m}=e,u=a.useCallback(e=>{r(e),m({fileKey:e.key,nodeIds:[]})},[m]),_=e=>c(()=>e);return a.createElement(M.XV,{title:(()=>{switch(s){case 1:return(0,i.t)("fig_feed.choose_a_file");case 2:return a.createElement("div",{className:g()("post_from_file_modal--leftButtonGroup--ZT4p5",e.lockFileSelection&&"post_from_file_modal--headerPadding--6G68d")},!e.lockFileSelection&&a.createElement(D.K0,{svg:A.A,onClick:()=>_(1),"data-tooltip":(0,i.t)("fig_feed.button.back"),"data-tooltip-type":S.Ib.TEXT})," ",(null==o?void 0:o.name)??"");default:(0,C.xb)(s)}})(),onClose:n,containerClassName:"post_from_file_modal--modalView--qMQ2p",innerContainerClassName:"post_from_file_modal--innerModalView--CfMj1",disableClickOutsideToHide:!0,maxWidth:1===s?1024:680,closeOnEsc:!0},(()=>{switch(s){case 1:return a.createElement(W,{orgId:e.orgId,setModalPage:_,setSelectedFile:u,hideModal:n,skipFrameSelection:e.skipFrameSelection});case 2:if(!o)return null;return a.createElement(R,{selectedFile:o,hideModal:n,setNodeInfo:e.setFeedPostNodeInfo});default:(0,C.xb)(s)}})())},"PostFromFileModal");function z(e,t,n,a,l){if(!a||!e)return;let r=e.nodeIds.filter(e=>!t.has(e));0!==r.length&&(queueMicrotask(()=>{(0,o.flushSync)(()=>{n(t=>[...t,...(0,_.Px)(e.fileKey,r,a)])})}),(0,_.Rl)(e.fileKey,r,a,l,e.nodeThumbnails,e.backgroundColorByNode).then(e=>{n(t=>t.map(t=>t.displayContentItem.type===u.cM.NODE&&t.displayContentItem.isLoading?e[t.displayContentItem.nodeId]:t))}))}function H(e){let{setLinkedFileNodeInfo:t,numUserContentItems:n,hasNodeContent:o,parentModalRef:r,attachedFileKey:c,lockedFileKey:_,currentOrgId:f}=e,p=(0,l.wA)(),g=m.M4.useFile(c).data,C=a.useCallback(e=>{if(!_||e.fileKey===_){if(e.nodeIds.length+n>u.e3){p(s.F.enqueue({message:(0,i.t)("fig_feed.too_many_content_items",{maxNum:u.e3})}));return}t(t=>{let n=e.nodeIds,a=e.nodeThumbnails,o=e.backgroundColorByNode;return t&&e.fileKey===t.fileKey?{fileKey:t.fileKey,nodeIds:[...new Set(t.nodeIds.concat(n))],nodeThumbnails:{...t.nodeThumbnails,...a},backgroundColorByNode:{...t.backgroundColorByNode,...o}}:{fileKey:e.fileKey,nodeIds:n,nodeThumbnails:a,backgroundColorByNode:o}})}},[p,n,_,t]);return{openPostFromFileModal:a.useCallback(e=>{f&&p((0,d.to)({type:U,data:{orgId:f,setFeedPostNodeInfo:C,attachedFile:g,parentRef:r,lockFileSelection:_||g&&o,skipFrameSelection:null==e?void 0:e.skipFrameSelection}}))},[p,f,C,g,_,o,r]),attachedFileData:g}}function $(e,t){return{setContentPreview:a.useCallback((n,a,o)=>{let l=Array.from(e),i=l.findIndex(e=>(0,f.K1)(e.displayContentItem)===n),s=l[i];if(s&&(0,u.aT)(s.displayContentItem)){s.preview={url:a,state:o};let e=s.displayContentItem;e.preview_image_url=a,e.backgroundColor=(0,r.colorToHex)(o.backgroundColor),t(l)}else console.error("expected to find matched content item")},[e,t]),snapshotStates:a.useMemo(()=>e.reduce((e,t)=>(t.preview?e[(0,f.K1)(t.displayContentItem)]=t.preview.state:(0,_.EU)(t.displayContentItem)&&(e[(0,f.K1)(t.displayContentItem)]={x:t.displayContentItem.initialX,y:t.displayContentItem.initialY,zoom:t.displayContentItem.initialZoom,ratio:1,backgroundColor:(0,c.dy)(t.displayContentItem.backgroundColor)}),e),{}),[e])}}},919960:(e,t,n)=>{n.d(t,{zr:()=>Z,xM:()=>V,lU:()=>z,Qn:()=>j});var a=n(411855),o=n(188507),l=n(629019),r=n.n(l),i=n(776250),s=n(297666),d=n(320063);if(443==n.j)var c=n(860601);var m=n(547807),u=n(572206),_=n(268537),f=n(659838),p=n(493323),g=n(827586),C=n(32863),h=n(574176),y=n(24973);function E(e){let{tabs:t,selectedTabKey:n,onTabClick:o}=e;return a.createElement("div",{className:y.vR},t.map(e=>a.createElement("button",{key:e.key,className:e.key===n?y.xR:y.Mf,onClick:()=>o(e.key)},e.label)))}var v=n(762638),b=n(939863),w=n(392592),I=n(738269),k=n(767518);class x{constructor(e,t={list:k.U.getFeedPostCreators,search:k.U.searchFeedPostCreators}){this.api=t,this.orgId=e}async list(){try{let{data:{meta:e}}=await this.api.list({orgId:this.orgId});return e}catch(e){console.error("An error ocurred while trying to fetch feed post creator contacts.",e)}return[]}async search(e){try{let{data:{meta:t}}=await this.api.search({query:e,orgId:this.orgId});return t}catch(e){console.error("An error ocurred while searching for feed post creator contacts.",e)}return[]}maxResultsLength(){return 100}}var S=n(860178),N=n(103271),F=n(498606),T=n(290237),D=n(260262),M=n(720488),P=n(746806),O=n(563288);let A="feed_list_filters--dropdownOption--L2vCH feed_list_filters--dropdownOptionBase--S-hRH",B="feed_list_filters--containerOptionContentText--D4-Oc";if(443==n.j)var L=n(112512);var R=n(639685),K=n(524289),W=n(630834);let U="feed-user-filter-dropdown",z="feed-container-creation-dropdown";var H=(e=>(e[e.DEFAULT=0]="DEFAULT",e[e.LIGHT=1]="LIGHT",e))(H||{});function $(){return a.createElement("div",{className:"feed_list_filters--dropdownSeparator--5CG0F"})}function G(e){let{setSelectedOption:t}=e,n=a.useRef(null),o=a.useRef(""),[l,r]=a.useState(""),[i,d]=a.useState([]),[c,m]=a.useState(!1),{search:y}=e,E=a.useCallback(async e=>{try{m(!0);let t=await y(e);d(t)}catch(e){console.error(e)}finally{m(!1)}},[y]);a.useEffect(()=>{l&&o.current!==l&&E(l),o.current=l},[l,E]);let v=(0,s.s)(r,250),w=a.useCallback(()=>r(""),[]),I=a.useCallback(e=>{v(e)},[v]),{searchInputRef:k,onMouseDown:x,onMouseUp:S,onBlur:N,onSearchChange:F,onSearchKeyDown:T,onClearSearchClick:O,onClearSearchKeyDown:B}=(0,C.ne)({query:l,focusOnMount:!1,clearSearch:w,onChange:I},n),L=a.useCallback(e=>{"Enter"===e.key&&B(e),e.stopPropagation()},[B]),K=a.useCallback(e=>()=>{t(e)},[t]);return a.createElement(D.N,{dropdownId:e.dropdownId,renderDropdown:t=>{let n=a.createElement("div",{className:"feed_list_filters--searchBar--SmGQW",key:"search-bar"},a.createElement(h.B,{className:"feed_list_filters--searchIcon--uk2jc",svg:R.A}),a.createElement(f.L,{className:"feed_list_filters--searchInput--fYyKR",ref:k,placeholder:e.searchPlaceholder,value:l,onChange:F,onKeyDown:T,onMouseDown:x,onMouseUp:S,onBlur:N,style:{width:"100%"},autoFocus:!0}),!!l&&a.createElement("button",{className:"feed_list_filters--closeButton--57DHM",onClick:O,onKeyDown:L},a.createElement(h.B,{svg:W.default}))),o=l?i:e.initialOptions,r=(t,n,o,l)=>{switch(t.optionType){case"no_matching_results":return a.createElement("div",{key:"no-matching-results",className:"feed_list_filters--dropdownOptionNoMatchingResults--QuGf9 feed_list_filters--dropdownOptionBase--S-hRH"},(0,b.tx)("fig_feed.no_matching_results"));case"group":let i=`${n}-group`;return a.createElement(a.Fragment,{key:`${n}-frag`},t.label&&a.createElement("div",{className:"feed_list_filters--dropdownGroupHeader--GzXg- feed_list_filters--dropdownOptionBase--S-hRH"},t.label),t.options.map((e,t)=>r(e,t,i)),!l&&a.createElement($,null));case"option":return a.createElement(_.MM,{key:`${n}-${t.id}${o?`-${o}`:""}`,className:A,onClick:K(t),checked:e.selectedOption===t.id},t.display)}},s=a.createElement(g.P,{maxHeight:e.maxContentHeight,hideScrollbar:!0},e.defaultDisplay&&a.createElement(a.Fragment,null,a.createElement(_.MM,{className:A,onClick:K(null),checked:null===e.selectedOption},e.defaultDisplay),a.createElement($,null)),c?a.createElement("div",{className:"feed_list_filters--loadingSpinner--Pe67Z"},a.createElement(p.kt,{size:"small"})):o.map((e,t)=>r(e,t,void 0,t===o.length-1))),d=a.createElement(a.Fragment,null,n,a.createElement($,{key:"initial-separator"}),s);return 1===e.type?a.createElement(P.vx,{title:"",headerSize:"hidden",initialConstraints:{x:"left",y:"bottom"},initialPosition:new u.Mi(t.x,window.innerHeight-t.bottom),initialWidth:300,maxWidth:300,dragHeaderOnly:!1,containerClassName:"feed_list_filters--dropdownModalContainer--17bB-",frameStyle:{borderRadius:"4px"},disableDragging:!0},a.createElement("div",{className:"feed_list_filters--lightDropdown--mlEQW"},d)):a.createElement(M.Cf,{showPoint:!0,targetRect:t,lean:"left",minWidth:300,maxWidth:300,disableDropdownScrollContainer:!0,propagateCloseClick:!0},a.createElement("div",{className:"feed_list_filters--defaultDropdown--723ga"},d))},hideOverflow:!0},e.children)}let Q=(0,m.vh)();function V(e){let t=e.defaultContainer&&e.option.id===e.defaultContainer.id&&e.option.type===e.defaultContainer.type,n=e.defaultContainer&&!t&&e.setDefaultContainer,o=e.showSecretTeamTooltip&&e.option.isPrivate?(0,b.t)("fig_feed.secret_team_tooltip",{containerName:e.option.name}):void 0;return a.createElement("div",{className:"feed_list_filters--containerOptionWrapper--4u6Op"},a.createElement("div",{className:"feed_list_filters--containerOptionContent--QdBnH","data-tooltip-type":F.Ib.TEXT,"data-tooltip":o},a.createElement(O.lO,{containerInfo:{type:e.option.type},withoutTooltip:!0}),a.createElement("div",{className:"feed_list_filters--containerOptionContentInner--LFrFD"},a.createElement("div",{className:B},e.option.name),e.option.isPrivate&&a.createElement(h.B,{className:"feed_list_filters--containerPrivateIcon--4xKbs",svg:K.A}),t&&a.createElement("div",{className:"feed_list_filters--defaultLabel--cbaPB"},(0,b.tx)("fig_feed.default_in_parens")))),e.showMemberCount&&null!=e.option.memberCount&&a.createElement("div",{className:r()("feed_list_filters--containerMemberCountWrapper--0me3F")},a.createElement("div",{className:r()("feed_list_filters--containerMemberCount--it5uh",{"feed_list_filters--hideOnHover--W-LgR":n})},(0,b.tx)("fig_feed.num_members",{numMembers:e.option.memberCount??0})),n&&a.createElement("div",{className:"feed_list_filters--setDefaultContainer--Fjrjh",onMouseDown:t=>{var n;t.stopPropagation(),null==(n=e.setDefaultContainer)||n.call(e,e.option)},role:"button",tabIndex:0},(0,b.tx)("fig_feed.set_as_default"))))}function Z(e){var t;let n=(0,o.wA)(),[l,r]=a.useState(e.selectedContainer?[{...e.selectedContainer,optionType:"option",display:e.selectedContainer.name??""}]:[]),{onContainerSelect:s,onSetDefaultContainer:c}=e,m=(0,S.iZ)(),u=a.useCallback(t=>{var a,o;(t.id!==(null==(a=e.defaultContainer)?void 0:a.id)||t.type!==(null==(o=e.defaultContainer)?void 0:o.type))&&((0,i.sx)("Team Feed Set Default Audience",{containerId:t.id,containerType:t.type,userId:null==m?void 0:m.id,orgId:e.orgId}),T.X.setDefaultContainer({containerId:t.id,containerType:(0,O.FD)(t.type),orgId:e.orgId}).then(()=>{s(t),c(t),n(w.F.enqueue({message:(0,b.t)("fig_feed.new_default_container_has_been_set")}))}))},[n,e.orgId,s,c,null==m?void 0:m.id,e.defaultContainer]),_=a.useCallback(async t=>{let n=`/api/feed_posts/${e.orgId}/containers`,o=new URLSearchParams;t&&o.append("query",t),e.showMemberCount&&o.append("with_member_count","true"),e.showUnusedContainers&&o.append("with_unused_containers","true");let l=`${n}?${o.toString()}`;try{let n=await Q.validate(async({xr:e})=>await e.get(l)).then(e=>e.data.meta),o=t=>{let n=(0,O.Ti)(t.container_type),o={id:t.container_id,type:n,name:t.display_name,isPrivate:t.is_private,memberCount:t.member_count};return{optionType:"option",...o,display:a.createElement(V,{option:o,defaultContainer:e.defaultContainer,showMemberCount:e.showMemberCount,setDefaultContainer:u})}},r=(e,t)=>({optionType:"group",label:t,options:e.map(o)}),i=e.selectedContainer&&e.selectedContainer.id&&e.selectedContainer.type&&n.member_results.concat(n.results).some(t=>t.container_id===e.selectedContainer.id&&(0,O.Ti)(t.container_type)===e.selectedContainer.type),s=[];return!i&&e.selectedContainer&&s.push(r([{container_id:e.selectedContainer.id,container_type:(0,O.FD)(e.selectedContainer.type),display_name:e.selectedContainer.name,is_private:e.selectedContainer.isPrivate}],null)),0===n.member_results.length&&0===n.results.length?s.push({optionType:"no_matching_results"}):(n.member_results.length>0&&s.push(r(n.member_results,t?(0,b.t)("fig_feed.your_spaces"):(0,b.t)("fig_feed.your_recent_spaces"))),n.results.length>0&&s.push(r(n.results,t?(0,b.t)("fig_feed.other_spaces"):(0,b.t)("fig_feed.other_recent_spaces")))),s}catch(e){console.error(e)}return[]},[e.orgId,e.showMemberCount,e.showUnusedContainers,e.selectedContainer,e.defaultContainer,u]);(0,d.h)(()=>{_(null).then(e=>r(e))});let f=0;return e.dropdownId===z&&(f=1),a.createElement(G,{dropdownId:e.dropdownId,search:_,searchPlaceholder:(0,b.t)("fig_feed.placeholder.container_search"),defaultDisplay:e.hideAllSpaces?void 0:(0,b.t)("fig_feed.all_spaces"),initialOptions:l,selectedOption:(null==(t=e.selectedContainer)?void 0:t.id)??null,setSelectedOption:t=>{e.onContainerSelect(t)},type:f,maxContentHeight:344},e.children)}function q(e){var t;let[n,o]=a.useState([]),l=a.useMemo(()=>new x(e.orgId),[e.orgId]),r=e=>e.map(e=>({optionType:"option",id:e.id,display:a.createElement("div",{className:B},e.handle),handle:e.handle}));a.useEffect(()=>{l.list().then(e=>o(r(e.slice(0,l.maxResultsLength()))))},[l]);let i=async e=>{let t=await l.search(e);return 0===t.length?[{optionType:"no_matching_results"}]:r(t)};return a.createElement(G,{dropdownId:U,search:i,searchPlaceholder:(0,b.t)("fig_feed.placeholder.user_search"),defaultDisplay:(0,b.t)("fig_feed.all_users"),initialOptions:n,type:0,selectedOption:(null==(t=e.selectedUser)?void 0:t.id)??null,setSelectedOption:t=>e.onUserSelect(t),maxContentHeight:344},e.children)}function j(e){let t=(0,o.wA)(),{setSelectedContainer:n,setSelectedUser:l}=e,r=a.useCallback(e=>{l(e)},[l]),i=e.selectedContainer?e.selectedContainer.name:(0,b.t)("fig_feed.all_spaces").toLocaleLowerCase(),s=e.selectedUser?e.selectedUser.handle:(0,b.t)("fig_feed.all_users").toLocaleLowerCase(),d=e=>a.createElement("div",{className:v.cx.flex.selectNone.overflowHidden.$},a.createElement("span",{className:v.cx.overflowHidden.ellipsis.noWrap.flexShrink1.$},e),a.createElement("div",{className:v.cx.flex.itemsCenter.justifyCenter.w16.colorIcon.$},a.createElement(h.B,{svg:L.A})));return a.createElement(a.Fragment,null,a.createElement("div",{className:v.cx.flex.itemsCenter.justifyBetween.mr8.h64.$},a.createElement("div",{className:v.cx.py12.pr8.$},a.createElement(E,{tabs:e.tabs,selectedTabKey:e.selectedTabKey,onTabClick:t=>{e.setSelectedTabKey(t)}})),e.selectedTabKey===N.S8.All&&a.createElement("div",{className:v.cx.flex.gap16.$},a.createElement("div",{className:v.cx.flex.itemsCenter.gap4.maxW150.overflowHidden.$},a.createElement("label",{id:"feed-space-dropdown-label"},(0,b.tx)("fig_feed.label.in")),a.createElement(Z,{dropdownId:"feed-container-filter-dropdown",orgId:e.orgId,selectedContainer:e.selectedContainer,onContainerSelect:e=>{n(e),t(I.oB())},defaultContainer:null,onSetDefaultContainer:c.lQ,showMemberCount:!1},d(i))),a.createElement("div",{className:v.cx.flex.itemsCenter.gap4.maxW150.overflowHidden.$},a.createElement("label",{id:"feed-space-dropdown-label"},(0,b.tx)("fig_feed.label.by")),a.createElement(q,{dropdownId:U,orgId:e.orgId,selectedUser:e.selectedUser,onUserSelect:r},d(s))))))}}}]);

//# debugId=2d45c2cb-cfb6-5d80-89b0-0b732460c99b

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/0396e08c1ea62c00e41d4d3867ffdf6027015567/9082-d06d8ffc048eb9fa.min.js.map